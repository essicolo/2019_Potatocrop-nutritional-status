<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Ionome perturbation concept | Balancing the nutritional status of potato crops.</title>
  <meta name="description" content="We use the bookdown package to write a book that describs the statistical computations of my PhD Project, for publication on Github." />
  <meta name="generator" content="bookdown 0.15 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Ionome perturbation concept | Balancing the nutritional status of potato crops." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="We use the bookdown package to write a book that describs the statistical computations of my PhD Project, for publication on Github." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Ionome perturbation concept | Balancing the nutritional status of potato crops." />
  
  <meta name="twitter:description" content="We use the bookdown package to write a book that describs the statistical computations of my PhD Project, for publication on Github." />
  

<meta name="author" content="Zonlehoua Coulibali and Serge-Étienne Parent" />


<meta name="date" content="2020-01-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapter-Modeling.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Data processing</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objective"><i class="fa fa-check"></i><b>1.1</b> Objective</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#useful-libraries-for-data-handling"><i class="fa fa-check"></i><b>1.2</b> Useful libraries for data handling</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#quebec-potato-data-set"><i class="fa fa-check"></i><b>1.3</b> Québec potato data set</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#selection-of-useful-variables"><i class="fa fa-check"></i><b>1.4</b> Selection of useful variables</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#arranging-the-data-frame"><i class="fa fa-check"></i><b>1.5</b> Arranging the data frame</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#cultivar-classes-correction"><i class="fa fa-check"></i><b>1.6</b> Cultivar classes correction</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#summarise-and-backup"><i class="fa fa-check"></i><b>1.7</b> Summarise and backup</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html"><i class="fa fa-check"></i><b>2</b> Ionome analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#objective-1"><i class="fa fa-check"></i><b>2.1</b> Objective</a></li>
<li class="chapter" data-level="2.2" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#useful-libraries-and-custom-functions"><i class="fa fa-check"></i><b>2.2</b> Useful libraries and custom functions</a></li>
<li class="chapter" data-level="2.3" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#leaves-processed-compositions-data-set"><i class="fa fa-check"></i><b>2.3</b> Leaves processed compositions data set</a></li>
<li class="chapter" data-level="2.4" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#the-yield-cut-off-low-and-high-yielders-delimiter"><i class="fa fa-check"></i><b>2.4</b> The yield cut-off, low and high yielders delimiter</a></li>
<li class="chapter" data-level="2.5" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#centered-log-ratio-clr-centroids-computation"><i class="fa fa-check"></i><b>2.5</b> Centered log-ratio (clr) centroids computation</a></li>
<li class="chapter" data-level="2.6" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#clustering-potato-cultivars-with-leaf-ionome"><i class="fa fa-check"></i><b>2.6</b> Clustering potato cultivars with leaf ionome</a></li>
<li class="chapter" data-level="2.7" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#axis-reduction"><i class="fa fa-check"></i><b>2.7</b> Axis reduction</a></li>
<li class="chapter" data-level="2.8" data-path="Chapter-Clustering.html"><a href="Chapter-Clustering.html#do-clrs-affect-potato-tuber-yield"><i class="fa fa-check"></i><b>2.8</b> Do clrs affect potato tuber yield?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html"><i class="fa fa-check"></i><b>3</b> Predicting tuber yield category</a><ul>
<li class="chapter" data-level="3.1" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#objective-2"><i class="fa fa-check"></i><b>3.1</b> Objective</a></li>
<li class="chapter" data-level="3.2" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#useful-libraries"><i class="fa fa-check"></i><b>3.2</b> Useful libraries</a></li>
<li class="chapter" data-level="3.3" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#machine-learning-data-set"><i class="fa fa-check"></i><b>3.3</b> Machine learning data set</a></li>
<li class="chapter" data-level="3.4" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#machine-learning"><i class="fa fa-check"></i><b>3.4</b> Machine learning</a><ul>
<li class="chapter" data-level="3.4.1" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#data-train-and-test-splits"><i class="fa fa-check"></i><b>3.4.1</b> Data train and test splits</a></li>
<li class="chapter" data-level="3.4.2" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#building-the-models"><i class="fa fa-check"></i><b>3.4.2</b> Building the Models</a></li>
<li class="chapter" data-level="3.4.3" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#goodness-of-fit-on-training-set"><i class="fa fa-check"></i><b>3.4.3</b> Goodness of fit on training set</a></li>
<li class="chapter" data-level="3.4.4" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#models-evaluation-test-set"><i class="fa fa-check"></i><b>3.4.4</b> Models’ evaluation (test set)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#variable-importance-estimation"><i class="fa fa-check"></i><b>3.5</b> Variable importance estimation</a></li>
<li class="chapter" data-level="3.6" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#make-predictions-on-the-test-set-with-kknn-model"><i class="fa fa-check"></i><b>3.6</b> Make predictions on the test set with <code>kknn</code> model</a></li>
<li class="chapter" data-level="3.7" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#comparison-with-non-informative-classification"><i class="fa fa-check"></i><b>3.7</b> Comparison with non-informative classification</a></li>
<li class="chapter" data-level="3.8" data-path="Chapter-Modeling.html"><a href="Chapter-Modeling.html#nutritionally-balanced-compositions"><i class="fa fa-check"></i><b>3.8</b> Nutritionally balanced compositions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chapter-Perturbation.html"><a href="Chapter-Perturbation.html"><i class="fa fa-check"></i><b>4</b> Ionome perturbation concept</a><ul>
<li class="chapter" data-level="4.1" data-path="Chapter-Perturbation.html"><a href="Chapter-Perturbation.html#objective-3"><i class="fa fa-check"></i><b>4.1</b> Objective</a></li>
<li class="chapter" data-level="4.2" data-path="Chapter-Perturbation.html"><a href="Chapter-Perturbation.html#data-set-and-useful-libraries"><i class="fa fa-check"></i><b>4.2</b> Data set and useful libraries</a></li>
<li class="chapter" data-level="4.3" data-path="Chapter-Perturbation.html"><a href="Chapter-Perturbation.html#euclidean-distance-from-nutritionally-balanced-compositions"><i class="fa fa-check"></i><b>4.3</b> Euclidean distance from nutritionally balanced compositions</a></li>
<li class="chapter" data-level="4.4" data-path="Chapter-Perturbation.html"><a href="Chapter-Perturbation.html#perturbation-effect-of-some-elements-on-the-whole"><i class="fa fa-check"></i><b>4.4</b> Perturbation effect of some elements on the whole</a></li>
<li class="chapter" data-level="4.5" data-path="Chapter-Perturbation.html"><a href="Chapter-Perturbation.html#rebalancing-a-misbalanced-sample-by-perturbation"><i class="fa fa-check"></i><b>4.5</b> Rebalancing a misbalanced sample by perturbation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="5" data-path="index.html"><a href="index.html#Chapter-Data-Processing"><i class="fa fa-check"></i><b>5</b> Data processing</a><ul>
<li class="chapter" data-level="5.1" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html"><i class="fa fa-check"></i><b>5.1</b> Objective</a></li>
<li class="chapter" data-level="5.2" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#useful-libraries-for-data-handling-1"><i class="fa fa-check"></i><b>5.2</b> Useful libraries for data handling</a></li>
<li class="chapter" data-level="5.3" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#quebec-potato-data-set-1"><i class="fa fa-check"></i><b>5.3</b> Québec potato data set</a></li>
<li class="chapter" data-level="5.4" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#selection-of-useful-variables-1"><i class="fa fa-check"></i><b>5.4</b> Selection of useful variables</a></li>
<li class="chapter" data-level="5.5" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#arranging-the-data-frame-1"><i class="fa fa-check"></i><b>5.5</b> Arranging the data frame</a></li>
<li class="chapter" data-level="5.6" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#cultivar-classes-correction-1"><i class="fa fa-check"></i><b>5.6</b> Cultivar classes correction</a></li>
<li class="chapter" data-level="5.7" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#summarise-and-backup-1"><i class="fa fa-check"></i><b>5.7</b> Summarise and backup</a></li>
<li class="chapter" data-level="5.8" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#objective-5"><i class="fa fa-check"></i><b>5.8</b> Objective</a></li>
<li class="chapter" data-level="5.9" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#useful-libraries-and-custom-functions-1"><i class="fa fa-check"></i><b>5.9</b> Useful libraries and custom functions</a></li>
<li class="chapter" data-level="5.10" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#leaves-processed-compositions-data-set-1"><i class="fa fa-check"></i><b>5.10</b> Leaves processed compositions data set</a></li>
<li class="chapter" data-level="5.11" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#the-yield-cut-off-low-and-high-yielders-delimiter-1"><i class="fa fa-check"></i><b>5.11</b> The yield cut-off, low and high yielders delimiter</a></li>
<li class="chapter" data-level="5.12" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#centered-log-ratio-clr-centroids-computation-1"><i class="fa fa-check"></i><b>5.12</b> Centered log-ratio (clr) centroids computation</a></li>
<li class="chapter" data-level="5.13" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#clustering-potato-cultivars-with-leaf-ionome-1"><i class="fa fa-check"></i><b>5.13</b> Clustering potato cultivars with leaf ionome</a></li>
<li class="chapter" data-level="5.14" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#axis-reduction-1"><i class="fa fa-check"></i><b>5.14</b> Axis reduction</a></li>
<li class="chapter" data-level="5.15" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#do-clrs-affect-potato-tuber-yield-1"><i class="fa fa-check"></i><b>5.15</b> Do clrs affect potato tuber yield?</a></li>
<li class="chapter" data-level="5.16" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#objective-6"><i class="fa fa-check"></i><b>5.16</b> Objective</a></li>
<li class="chapter" data-level="5.17" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#useful-libraries-1"><i class="fa fa-check"></i><b>5.17</b> Useful libraries</a></li>
<li class="chapter" data-level="5.18" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#machine-learning-data-set-1"><i class="fa fa-check"></i><b>5.18</b> Machine learning data set</a></li>
<li class="chapter" data-level="5.19" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#machine-learning-1"><i class="fa fa-check"></i><b>5.19</b> Machine learning</a><ul>
<li class="chapter" data-level="5.19.1" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#data-train-and-test-splits-1"><i class="fa fa-check"></i><b>5.19.1</b> Data train and test splits</a></li>
<li class="chapter" data-level="5.19.2" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#building-the-models-1"><i class="fa fa-check"></i><b>5.19.2</b> Building the Models</a></li>
<li class="chapter" data-level="5.19.3" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#goodness-of-fit-on-training-set-1"><i class="fa fa-check"></i><b>5.19.3</b> Goodness of fit on training set</a></li>
<li class="chapter" data-level="5.19.4" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#models-evaluation-test-set-1"><i class="fa fa-check"></i><b>5.19.4</b> Models’ evaluation (test set)</a></li>
</ul></li>
<li class="chapter" data-level="5.20" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#variable-importance-estimation-1"><i class="fa fa-check"></i><b>5.20</b> Variable importance estimation</a></li>
<li class="chapter" data-level="5.21" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#make-predictions-on-the-test-set-with-kknn-model-1"><i class="fa fa-check"></i><b>5.21</b> Make predictions on the test set with <code>kknn</code> model</a></li>
<li class="chapter" data-level="5.22" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#comparison-with-non-informative-classification-1"><i class="fa fa-check"></i><b>5.22</b> Comparison with non-informative classification</a></li>
<li class="chapter" data-level="5.23" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#nutritionally-balanced-compositions-1"><i class="fa fa-check"></i><b>5.23</b> Nutritionally balanced compositions</a></li>
<li class="chapter" data-level="5.24" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#objective-7"><i class="fa fa-check"></i><b>5.24</b> Objective</a></li>
<li class="chapter" data-level="5.25" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#data-set-and-useful-libraries-1"><i class="fa fa-check"></i><b>5.25</b> Data set and useful libraries</a></li>
<li class="chapter" data-level="5.26" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#euclidean-distance-from-nutritionally-balanced-compositions-1"><i class="fa fa-check"></i><b>5.26</b> Euclidean distance from nutritionally balanced compositions</a></li>
<li class="chapter" data-level="5.27" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#perturbation-effect-of-some-elements-on-the-whole-1"><i class="fa fa-check"></i><b>5.27</b> Perturbation effect of some elements on the whole</a></li>
<li class="chapter" data-level="5.28" data-path="Chapter-Data-Processing.html"><a href="Chapter-Data-Processing.html#rebalancing-a-misbalanced-sample-by-perturbation-1"><i class="fa fa-check"></i><b>5.28</b> Rebalancing a misbalanced sample by perturbation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Balancing the nutritional status of potato crops.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapter-Perturbation" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Ionome perturbation concept</h1>
<div id="objective-3" class="section level2">
<h2><span class="header-section-number">4.1</span> Objective</h2>
<hr />
<p>The objective of this chapter is to show the user a visual example of perturbation effect in a Simplex, and to develop a mathematical workflow useful to adjust the ionome of potato crops for diagnostic purpose.</p>
<blockquote>
<p>Perturbation in compositional space plays the same role as translation plays in real space. The assumption is that some natural processes in nature can be interpreted as a change from one composition <code>C1</code> to another <code>C2</code> through the application of a perturbation:</p>
</blockquote>
<blockquote>
<p>p ⊕ C1 ===&gt; C2.</p>
</blockquote>
<blockquote>
<p>The <code>difference</code> between <code>a new observation</code> and a closest healthy composition (closest true negative - TN) or <code>reference</code> composition can be back-transformed to the compositional space. The resulted vector is the <code>perturbation vector</code>.</p>
</blockquote>
<p>Theoretically, a misbalanced composition could be balanced (translated into a healthy zone) using a perturbation operation. Using this concept, ionome of a new cultivar could be assigned to the cultivar sharing similar leaf composition, and where nutrient requirements have been already documented by fertilizer trials.</p>
<p>We used the <strong>testing set</strong> to display the effect of a perturbation on the whole simplex. We selected two elements (N and P) and simulated an increase of their initial (observed) clr values by 20% (theoretically). The observed (observation) and new clr vector (perturbation) were back transformed to N, P, K, Ca, Mg and Fv compositional space for comparison.</p>
<p>Secondly, the procedure used to rebalance a misbalanced composition is decribed. As explained at the end of the Chapter <a href="Chapter-Modeling.html#Chapter-Modeling">3</a>, we consider as True Negatives (TN) specimens (or healthy points) for this study, observations of the <strong>training set</strong> having a high yield (HY) and correctly predicted by the <strong>k nearest neighbors</strong> model.</p>
<hr />
</div>
<div id="data-set-and-useful-libraries" class="section level2">
<h2><span class="header-section-number">4.2</span> Data set and useful libraries</h2>
<p>We need package <a href="https://www.rdocumentation.org/packages/compositions/versions/1.40-2">compositions</a> for further clr back-transformation to compositional space. The package <a href="https://cran.r-project.org/web/packages/reshape/index.html">reshape</a> will be used to melt an intermediate data frame.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(<span class="st">&quot;extrafont&quot;</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(<span class="st">&#39;compositions&#39;</span>)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(<span class="st">&quot;reshape&quot;</span>)</a></code></pre></div>
<p>The previous <code>train_df</code> and <code>test_df</code> are loaded.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">train_df =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;output/train_df.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   NoEssai = col_double(),
##   NoBloc = col_double(),
##   NoTraitement = col_double(),
##   clr_N = col_double(),
##   clr_P = col_double(),
##   clr_K = col_double(),
##   clr_Ca = col_double(),
##   clr_Mg = col_double(),
##   clr_Fv = col_double(),
##   RendVendable = col_double(),
##   rv_cut = col_double(),
##   yieldClass = col_character(),
##   Maturity5 = col_character(),
##   Cultivar = col_character(),
##   pred_yield = col_character()
## )</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">test_df =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;output/test_df.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   NoEssai = col_double(),
##   NoBloc = col_double(),
##   NoTraitement = col_double(),
##   clr_N = col_double(),
##   clr_P = col_double(),
##   clr_K = col_double(),
##   clr_Ca = col_double(),
##   clr_Mg = col_double(),
##   clr_Fv = col_double(),
##   RendVendable = col_double(),
##   rv_cut = col_double(),
##   yieldClass = col_character(),
##   Maturity5 = col_character(),
##   Cultivar = col_character(),
##   pred_yield = col_character()
## )</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">TNs =<span class="st"> </span>train_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(yieldClass <span class="op">==</span><span class="st"> &#39;HY&#39;</span> <span class="op">&amp;</span><span class="st"> </span>pred_yield <span class="op">==</span><span class="st"> &#39;HY&#39;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">clr_no =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clr_N&quot;</span>, <span class="st">&quot;clr_P&quot;</span>, <span class="st">&quot;clr_K&quot;</span>, <span class="st">&quot;clr_Ca&quot;</span>, <span class="st">&quot;clr_Mg&quot;</span>, <span class="st">&quot;clr_Fv&quot;</span>)</a></code></pre></div>
<p>Filtrer train_df et test_df pour ne conserver que les observations ayant les cultivars correspondant dans les vrais négatifs, et seulement les déséquilibrés.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">train_df &lt;-<span class="st"> </span>train_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Cultivar <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(TNs<span class="op">$</span>Cultivar))</a>
<a class="sourceLine" id="cb7-2" title="2">test_df &lt;-<span class="st"> </span>test_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Cultivar <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(TNs<span class="op">$</span>Cultivar))</a></code></pre></div>
</div>
<div id="euclidean-distance-from-nutritionally-balanced-compositions" class="section level2">
<h2><span class="header-section-number">4.3</span> Euclidean distance from nutritionally balanced compositions</h2>
<p>The chunk below activates the custom function used to compute Euclidean distance.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">eucl_dist_f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb8-2" title="2">    <span class="kw">sqrt</span>(<span class="kw">sum</span>((x<span class="op">-</span>y)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-3" title="3">}</a></code></pre></div>
<p>For each imbalanced composition, we use the next loop to compute all the euclidean distances between all the compositions in “TNs” of the corresponding cultivar. The computation is possible even if the cultivar is unknown, the loop must just be updated. Here, the loop returns the smallest Euclidean distance stored in <code>debal</code> vector.</p>
<p>For train_df:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">debal &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb9-2" title="2">debal_index &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(train_df)) {</a>
<a class="sourceLine" id="cb9-4" title="4">    clr_i &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(train_df[i, clr_no])</a>
<a class="sourceLine" id="cb9-5" title="5">    TNs_target &lt;-<span class="st"> </span>TNs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Cultivar <span class="op">==</span><span class="st"> </span>train_df<span class="op">$</span>Cultivar[i]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(clr_no)</a>
<a class="sourceLine" id="cb9-6" title="6">    eucl_dist &lt;-<span class="st"> </span><span class="kw">apply</span>(TNs_target, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">eucl_dist_f</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> clr_i))</a>
<a class="sourceLine" id="cb9-7" title="7">    debal_index[i] &lt;-<span class="st"> </span><span class="kw">which.min</span>(eucl_dist)</a>
<a class="sourceLine" id="cb9-8" title="8">    debal[i] &lt;-<span class="st"> </span>eucl_dist[debal_index[i]]</a>
<a class="sourceLine" id="cb9-9" title="9">}</a>
<a class="sourceLine" id="cb9-10" title="10">train_df<span class="op">$</span>debal &lt;-<span class="st"> </span>debal</a>
<a class="sourceLine" id="cb9-11" title="11">train_df &lt;-<span class="st"> </span>train_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(debal <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb9-12" title="12">train_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 1,724
## Variables: 16
## $ NoEssai      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4, 4, 4, 4, 4...
## $ NoBloc       &lt;dbl&gt; 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 2, 2, 2, 2, 3, 3...
## $ NoTraitement &lt;dbl&gt; 1, 2, 3, 6, 1, 2, 8, 4, 5, 7, 1, 1, 2, 3, 4, 2, 3...
## $ clr_N        &lt;dbl&gt; 0.3321186, 0.4252302, 0.4453417, 0.4885647, 0.473...
## $ clr_P        &lt;dbl&gt; -2.518325, -2.394957, -2.365429, -2.525335, -2.28...
## $ clr_K        &lt;dbl&gt; 0.8379383, 1.1387291, 1.0112272, 0.9418880, 0.718...
## $ clr_Ca       &lt;dbl&gt; -0.4794688, -0.5154924, -0.7290838, -0.6426036, -...
## $ clr_Mg       &lt;dbl&gt; -1.639076, -2.346167, -1.990736, -1.763195, -1.69...
## $ clr_Fv       &lt;dbl&gt; 3.466813, 3.692658, 3.628680, 3.500681, 3.337752,...
## $ RendVendable &lt;dbl&gt; 18.944200, 40.351800, 33.037900, 41.016700, 15.11...
## $ rv_cut       &lt;dbl&gt; 41.33053, 41.33053, 41.33053, 41.33053, 41.33053,...
## $ yieldClass   &lt;chr&gt; &quot;LY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;HY&quot;, &quot;LY&quot;, &quot;...
## $ Maturity5    &lt;chr&gt; &quot;mid-season&quot;, &quot;mid-season&quot;, &quot;mid-season&quot;, &quot;mid-se...
## $ Cultivar     &lt;chr&gt; &quot;Goldrush&quot;, &quot;Goldrush&quot;, &quot;Goldrush&quot;, &quot;Goldrush&quot;, &quot;...
## $ pred_yield   &lt;chr&gt; &quot;LY&quot;, &quot;LY&quot;, &quot;HY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;HY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;...
## $ debal        &lt;dbl&gt; 0.4859422, 0.3245021, 0.2126167, 0.2987338, 0.384...</code></pre>
<p>For test_df:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">debal &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb11-2" title="2">debal_index &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(test_df)) {</a>
<a class="sourceLine" id="cb11-4" title="4">    clr_i &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(test_df[i, clr_no])</a>
<a class="sourceLine" id="cb11-5" title="5">    TNs_target &lt;-<span class="st"> </span>TNs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Cultivar <span class="op">==</span><span class="st"> </span>test_df<span class="op">$</span>Cultivar[i]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(clr_no)</a>
<a class="sourceLine" id="cb11-6" title="6">    eucl_dist &lt;-<span class="st"> </span><span class="kw">apply</span>(TNs_target, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">eucl_dist_f</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> clr_i))</a>
<a class="sourceLine" id="cb11-7" title="7">    debal_index[i] &lt;-<span class="st"> </span><span class="kw">which.min</span>(eucl_dist)</a>
<a class="sourceLine" id="cb11-8" title="8">    debal[i] &lt;-<span class="st"> </span>eucl_dist[debal_index[i]]</a>
<a class="sourceLine" id="cb11-9" title="9">}</a>
<a class="sourceLine" id="cb11-10" title="10">test_df<span class="op">$</span>debal &lt;-<span class="st"> </span>debal</a>
<a class="sourceLine" id="cb11-11" title="11">test_df &lt;-<span class="st"> </span>test_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(debal <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb11-12" title="12">test_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 803
## Variables: 16
## $ NoEssai      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 4, 4, 4, 4, 4, 5, 5, 5, 5...
## $ NoBloc       &lt;dbl&gt; 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 1, 1, 3, 1, 1, 1, 2...
## $ NoTraitement &lt;dbl&gt; 4, 5, 5, 6, 7, 1, 2, 8, 2, 3, 5, 6, 1, 2, 4, 5, 5...
## $ clr_N        &lt;dbl&gt; 0.3993264, 0.6519389, 0.5692523, 0.7251908, 0.507...
## $ clr_P        &lt;dbl&gt; -2.599180, -2.468221, -2.423432, -2.327678, -2.50...
## $ clr_K        &lt;dbl&gt; 0.7945826, 0.8242433, 0.7214698, 0.7597218, 0.676...
## $ clr_Ca       &lt;dbl&gt; -0.6220171, -0.7470790, -0.6610863, -0.6945233, -...
## $ clr_Mg       &lt;dbl&gt; -1.577529, -1.775074, -1.730285, -1.991205, -1.51...
## $ clr_Fv       &lt;dbl&gt; 3.604817, 3.514191, 3.524081, 3.528494, 3.430364,...
## $ RendVendable &lt;dbl&gt; 37.55050, 46.00890, 42.95690, 49.24620, 41.86690,...
## $ rv_cut       &lt;dbl&gt; 41.33053, 41.33053, 41.33053, 41.33053, 41.33053,...
## $ yieldClass   &lt;chr&gt; &quot;LY&quot;, &quot;HY&quot;, &quot;HY&quot;, &quot;HY&quot;, &quot;HY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;HY&quot;, &quot;...
## $ Maturity5    &lt;chr&gt; &quot;mid-season&quot;, &quot;mid-season&quot;, &quot;mid-season&quot;, &quot;mid-se...
## $ Cultivar     &lt;chr&gt; &quot;Goldrush&quot;, &quot;Goldrush&quot;, &quot;Goldrush&quot;, &quot;Goldrush&quot;, &quot;...
## $ pred_yield   &lt;chr&gt; &quot;HY&quot;, &quot;HY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;LY&quot;, &quot;HY&quot;, &quot;LY&quot;, &quot;...
## $ debal        &lt;dbl&gt; 0.48988609, 0.16712719, 0.23425051, 0.21198871, 0...</code></pre>
</div>
<div id="perturbation-effect-of-some-elements-on-the-whole" class="section level2">
<h2><span class="header-section-number">4.4</span> Perturbation effect of some elements on the whole</h2>
<p>This subsection illustrates the principle that strictly positive data constrained to some whole are inherently related to each other. Changing a proportion (so, perturbation on some proportion(s)) inherently affects at least another proportion, because such data convey only relative information <a href="https://rss.onlinelibrary.wiley.com/doi/abs/10.1111/j.2517-6161.1982.tb01195.x">(Aitchison, 1982)</a>.</p>
<p><code>leaf_clr_o</code> stands for original clr values of the tidded test set <code>test_df</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Compute (or select here) the clrs</span></a>
<a class="sourceLine" id="cb13-2" title="2">leaf_clr_o &lt;-<span class="st"> </span>test_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(clr_no)</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#leaf_clr_o &lt;- test_df %&gt;% </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#  filter(debal &gt;= quantile(train_df$debal, p = .75)) %&gt;% </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#  select(clr_no)</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw">summary</span>(leaf_clr_o)</a></code></pre></div>
<pre><code>##      clr_N            clr_P            clr_K             clr_Ca        
##  Min.   :0.0000   Min.   :-3.159   Min.   :-0.3560   Min.   :-1.98953  
##  1st Qu.:0.6253   1st Qu.:-2.171   1st Qu.: 0.2671   1st Qu.:-1.16304  
##  Median :0.7282   Median :-2.005   Median : 0.4315   Median :-1.00005  
##  Mean   :0.7227   Mean   :-2.004   Mean   : 0.4567   Mean   :-1.00711  
##  3rd Qu.:0.8349   3rd Qu.:-1.838   3rd Qu.: 0.6078   3rd Qu.:-0.84266  
##  Max.   :1.2106   Max.   :-1.186   Max.   : 1.8047   Max.   : 0.06082  
##      clr_Mg            clr_Fv     
##  Min.   :-2.7207   Min.   :2.969  
##  1st Qu.:-1.9545   1st Qu.:3.472  
##  Median :-1.7108   Median :3.547  
##  Mean   :-1.7294   Mean   :3.561  
##  3rd Qu.:-1.5006   3rd Qu.:3.640  
##  Max.   :-0.6952   Max.   :4.167</code></pre>
<p>Let’s perturb the original clr values for <code>N</code> and <code>P</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Perturb the original clrs</span></a>
<a class="sourceLine" id="cb15-2" title="2">pert_col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="co"># the column indices which is perturbed: clr_N and clr_K respectively</span></a>
<a class="sourceLine" id="cb15-3" title="3">perturbation &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>) <span class="co"># the amount added to the clr of the pert_col, same lenght as pert_col</span></a>
<a class="sourceLine" id="cb15-4" title="4">leaf_clr_f &lt;-<span class="st"> </span>leaf_clr_o</a>
<a class="sourceLine" id="cb15-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(pert_col)) {</a>
<a class="sourceLine" id="cb15-6" title="6">  leaf_clr_f[, pert_col[i]] &lt;-<span class="st"> </span>leaf_clr_f[, pert_col[i]] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>perturbation[i])</a>
<a class="sourceLine" id="cb15-7" title="7">}</a>
<a class="sourceLine" id="cb15-8" title="8"><span class="kw">summary</span>(leaf_clr_f)</a></code></pre></div>
<pre><code>##      clr_N            clr_P            clr_K             clr_Ca        
##  Min.   :0.0000   Min.   :-3.791   Min.   :-0.3560   Min.   :-1.98953  
##  1st Qu.:0.7503   1st Qu.:-2.605   1st Qu.: 0.2671   1st Qu.:-1.16304  
##  Median :0.8739   Median :-2.406   Median : 0.4315   Median :-1.00005  
##  Mean   :0.8672   Mean   :-2.404   Mean   : 0.4567   Mean   :-1.00711  
##  3rd Qu.:1.0019   3rd Qu.:-2.206   3rd Qu.: 0.6078   3rd Qu.:-0.84266  
##  Max.   :1.4528   Max.   :-1.423   Max.   : 1.8047   Max.   : 0.06082  
##      clr_Mg            clr_Fv     
##  Min.   :-2.7207   Min.   :2.969  
##  1st Qu.:-1.9545   1st Qu.:3.472  
##  Median :-1.7108   Median :3.547  
##  Mean   :-1.7294   Mean   :3.561  
##  3rd Qu.:-1.5006   3rd Qu.:3.640  
##  Max.   :-0.6952   Max.   :4.167</code></pre>
<p>The next one transforms clrs (original and perturbed clrs) back to compositions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co"># From clrs to compositions</span></a>
<a class="sourceLine" id="cb17-2" title="2">leaf_o &lt;-<span class="st"> </span><span class="kw">apply</span>(leaf_clr_o, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">exp</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">exp</span>(x))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>()</a>
<a class="sourceLine" id="cb17-3" title="3">leaf_f &lt;-<span class="st"> </span><span class="kw">apply</span>(leaf_clr_f, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">exp</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">exp</span>(x))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>()</a></code></pre></div>
<p>Then, we plot the original and perturbed ionomes to check a general tendency. <code>Observation</code> column plots the original “N”, “P”, “K”, “Ca”, “Mg” and “Fv” compositions, <code>Perturbation</code> represents new compositions after perturbation and <code>Difference</code> column stands for perturbation occured in the Observation to yied new compositions. Data are tidded before.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">rshleaf_o &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">data.frame</span>(leaf_o)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">vector =</span> <span class="kw">rep</span>(<span class="st">&quot;Observation&quot;</span>, <span class="kw">nrow</span>(.)))</a></code></pre></div>
<pre><code>## Using  as id variables</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">rshleaf_f &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">data.frame</span>(leaf_f)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">vector =</span> <span class="kw">rep</span>(<span class="st">&quot;Perturbation&quot;</span>, <span class="kw">nrow</span>(.)))</a></code></pre></div>
<pre><code>## Using  as id variables</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">rshdf &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(rshleaf_o, rshleaf_f)</a>
<a class="sourceLine" id="cb22-2" title="2">rshdf<span class="op">$</span>is_perturbed &lt;-<span class="st"> </span><span class="kw">ifelse</span>(rshdf<span class="op">$</span>variable <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(leaf_o[, pert_col]), </a>
<a class="sourceLine" id="cb22-3" title="3">                          <span class="st">&quot;Perturbed&quot;</span>, <span class="st">&quot;Not perturbed&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">rshdf<span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern =</span> <span class="st">&quot;clr_&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> rshdf<span class="op">$</span>variable, <span class="dt">fixed =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">  </span><span class="kw">fct_relevel</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Fv&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:wraped-perturb-boxplots"></span>
<img src="2019_Bookdown_files/figure-html/wraped-perturb-boxplots-1.png" alt="Perturbation effect of some elements on the whole." width="100%" />
<p class="caption">
Figure 4.1: Perturbation effect of some elements on the whole.
</p>
</div>
<p>All the components change when the clr of a single component is offset. The components whose clr has been perturbed obviously change the most (2-Perturbation). The component whose clr is the highest (generally Fv) compensate most of the perturbation. Although P clr values have been increased, P proportion decreased globally for the new equilibrium of the simplex.</p>
</div>
<div id="rebalancing-a-misbalanced-sample-by-perturbation" class="section level2">
<h2><span class="header-section-number">4.5</span> Rebalancing a misbalanced sample by perturbation</h2>
<p>Let’s suppose that we got this point selected at random in <code>imbalanced or misbalanced specimens</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">set.seed</span>(<span class="dv">92559</span>) </a>
<a class="sourceLine" id="cb24-2" title="2">imbalanced &lt;-<span class="st"> </span>train_df[<span class="kw">sample</span>(<span class="kw">nrow</span>(train_df), <span class="dv">1</span>), ]</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="kw">t</span>(imbalanced)</a></code></pre></div>
<pre><code>##              [,1]        
## NoEssai      &quot;412&quot;       
## NoBloc       &quot;1&quot;         
## NoTraitement &quot;9&quot;         
## clr_N        &quot;0.7735603&quot; 
## clr_P        &quot;-2.464426&quot; 
## clr_K        &quot;0.5688289&quot; 
## clr_Ca       &quot;-1.034959&quot; 
## clr_Mg       &quot;-1.660053&quot; 
## clr_Fv       &quot;3.817049&quot;  
## RendVendable &quot;34.74147&quot;  
## rv_cut       &quot;41.33053&quot;  
## yieldClass   &quot;LY&quot;        
## Maturity5    &quot;mid-season&quot;
## Cultivar     &quot;Goldrush&quot;  
## pred_yield   &quot;LY&quot;        
## debal        &quot;0.2208642&quot;</code></pre>
<p>Or even, we could rather use the most imbalanced occurrence, why not !</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">imbalanced &lt;-<span class="st"> </span>train_df[<span class="kw">which.max</span>(train_df<span class="op">$</span>debal), ]</a>
<a class="sourceLine" id="cb26-2" title="2">misbalanced &lt;-<span class="st"> </span>imbalanced <span class="co"># copy</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">t</span>(misbalanced)</a></code></pre></div>
<pre><code>##              [,1]              
## NoEssai      &quot;200&quot;             
## NoBloc       &quot;1&quot;               
## NoTraitement &quot;2&quot;               
## clr_N        &quot;0.957698&quot;        
## clr_P        &quot;-1.83199&quot;        
## clr_K        &quot;-0.04637332&quot;     
## clr_Ca       &quot;0.4678508&quot;       
## clr_Mg       &quot;-2.247862&quot;       
## clr_Fv       &quot;2.700677&quot;        
## RendVendable &quot;30.37194&quot;        
## rv_cut       &quot;32.6&quot;            
## yieldClass   &quot;LY&quot;              
## Maturity5    &quot;early mid-season&quot;
## Cultivar     &quot;Superior&quot;        
## pred_yield   &quot;LY&quot;              
## debal        &quot;1.345815&quot;</code></pre>
<p>How could we rebalance it? The first step is to find the closest balanced point in the TNs of the corresponding cultivar. Let’s re-compute its Euclidean distances from TNs and identify the TNs’ sample from which the distance is minimum.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">misbalanced &lt;-<span class="st"> </span>misbalanced[clr_no]</a>
<a class="sourceLine" id="cb28-2" title="2">eucl_dist_misbal &lt;-<span class="st"> </span><span class="kw">apply</span>(TNs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Cultivar <span class="op">==</span><span class="st"> </span>imbalanced<span class="op">$</span>Cultivar) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(clr_no), </a>
<a class="sourceLine" id="cb28-3" title="3">                          <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">eucl_dist_f</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> misbalanced))</a>
<a class="sourceLine" id="cb28-4" title="4"></a>
<a class="sourceLine" id="cb28-5" title="5">index_misbal &lt;-<span class="st"> </span><span class="kw">which.min</span>(<span class="kw">t</span>(<span class="kw">data.frame</span>(eucl_dist_misbal))) </a>
<a class="sourceLine" id="cb28-6" title="6">index_misbal <span class="co"># return the index of the sample</span></a></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p>The closest healthy sample is the one which index is 50 in TNs charing the same cultivar with the new sample. Using this index we could refind the minimum imbalance index value computed.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">(misbal &lt;-<span class="st"> </span>eucl_dist_misbal[index_misbal])</a></code></pre></div>
<pre><code>## [1] 1.345815</code></pre>
<p>The Euclidean distance matches with the corresponding <code>debal</code> value: <code>imbalanced$debal[1]</code> = 1.3458148. The <code>closest point in the TNs</code> subset is this one:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">target_TNs &lt;-<span class="st"> </span>TNs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Cultivar <span class="op">==</span><span class="st"> </span>imbalanced<span class="op">$</span>Cultivar)</a>
<a class="sourceLine" id="cb32-3" title="3">closest &lt;-<span class="st"> </span>target_TNs[index_misbal, ]</a>
<a class="sourceLine" id="cb32-4" title="4"><span class="kw">t</span>(closest)</a></code></pre></div>
<pre><code>##              [,1]              
## NoEssai      &quot;71&quot;              
## NoBloc       &quot;3&quot;               
## NoTraitement &quot;5&quot;               
## clr_N        &quot;0.5576154&quot;       
## clr_P        &quot;-2.078376&quot;       
## clr_K        &quot;0.4710692&quot;       
## clr_Ca       &quot;-0.3762287&quot;      
## clr_Mg       &quot;-2.022806&quot;       
## clr_Fv       &quot;3.448726&quot;        
## RendVendable &quot;37.56831&quot;        
## rv_cut       &quot;32.6&quot;            
## yieldClass   &quot;HY&quot;              
## Maturity5    &quot;early mid-season&quot;
## Cultivar     &quot;Superior&quot;        
## pred_yield   &quot;HY&quot;</code></pre>
<p>Note that <code>Cultivar</code> of the misbalanced and the closest healthy composition are the same. We compute the clr difference between the closest and the misbalanced points.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">closest =<span class="st"> </span>closest[clr_no]</a>
<a class="sourceLine" id="cb34-2" title="2">clr_diff =<span class="st"> </span>closest <span class="op">-</span><span class="st"> </span>misbalanced</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw">t</span>(clr_diff)</a></code></pre></div>
<pre><code>##              [,1]
## clr_N  -0.4000826
## clr_P  -0.2463863
## clr_K   0.5174425
## clr_Ca -0.8440794
## clr_Mg  0.2250562
## clr_Fv  0.7480496</code></pre>
<p>The perturbation vector is that clr difference back-transformed to leaf compositional space.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">comp_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Fv&quot;</span>)</a>
<a class="sourceLine" id="cb36-2" title="2">perturbation_vector &lt;-<span class="st"> </span><span class="kw">clrInv</span>(clr_diff)</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="kw">names</span>(perturbation_vector) &lt;-<span class="st"> </span>comp_names</a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw">t</span>(perturbation_vector)</a></code></pre></div>
<pre><code>##    [,1]      
## N  0.09679140
## P  0.11287200
## K  0.24227737
## Ca 0.06208853
## Mg 0.18085523
## Fv 0.30511547
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<p>Next, we should compute the corresponding compositions of the clr coordinates of the misbalanced point, as well as the closest TN point. The vectors could be gathered in a table made up of perturbation vector, misbalanced composition and the closest reference sample (pmc).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">misbal_comp &lt;-<span class="st"> </span><span class="kw">clrInv</span>(misbalanced)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">names</span>(misbal_comp) &lt;-<span class="st"> </span>comp_names</a>
<a class="sourceLine" id="cb38-3" title="3"></a>
<a class="sourceLine" id="cb38-4" title="4">closest_comp &lt;-<span class="st"> </span><span class="kw">clrInv</span>(closest)</a>
<a class="sourceLine" id="cb38-5" title="5"><span class="kw">names</span>(closest_comp) &lt;-<span class="st"> </span>comp_names</a>
<a class="sourceLine" id="cb38-6" title="6"></a>
<a class="sourceLine" id="cb38-7" title="7">pmc =<span class="st"> </span><span class="kw">rbind</span>(perturbation_vector, misbal_comp, closest_comp)</a>
<a class="sourceLine" id="cb38-8" title="8"><span class="kw">rownames</span>(pmc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;perturbation_vector&quot;</span>,<span class="st">&quot;misbal_comp&quot;</span>,<span class="st">&quot;closest_comp&quot;</span>)</a>
<a class="sourceLine" id="cb38-9" title="9">pmc</a></code></pre></div>
<pre><code>##                             N           P         K         Ca        Mg
## perturbation_vector 0.0967914 0.112872002 0.2422774 0.06208853 0.1808552
## misbal_comp         0.1282805 0.007881602 0.0470000 0.07860000 0.0052000
## closest_comp        0.0488500 0.003500000 0.0448000 0.01920000 0.0037000
##                            Fv
## perturbation_vector 0.3051155
## misbal_comp         0.7330379
## closest_comp        0.8799500</code></pre>
<p>We could even check that the simplex is closed to 1 for each vector.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">sum</span>(perturbation_vector); <span class="kw">sum</span>(misbal_comp); <span class="kw">sum</span>(closest_comp)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<pre><code>## [1] 1</code></pre>
<pre><code>## [1] 1</code></pre>
<p>The closest composition minus the misbalanced composition should return the perturbation vector.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">print</span>(closest_comp <span class="op">-</span><span class="st"> </span>misbal_comp)</a></code></pre></div>
<pre><code>##      N         P        K         Ca         Mg        Fv       
## [1,] 0.0967914 0.112872 0.2422774 0.06208853 0.1808552 0.3051155
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">print</span>(perturbation_vector) <span class="co"># for comparison</span></a></code></pre></div>
<pre><code>##      N         P        K         Ca         Mg        Fv       
## [1,] 0.0967914 0.112872 0.2422774 0.06208853 0.1808552 0.3051155
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<p>Or even, perturb the misbalanced point by the perturbation vector, you should obtain the closest TN point:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">print</span>(misbal_comp <span class="op">+</span><span class="st"> </span>perturbation_vector) <span class="co"># perturbation</span></a></code></pre></div>
<pre><code>##      N       P      K      Ca     Mg     Fv     
## [1,] 0.04885 0.0035 0.0448 0.0192 0.0037 0.87995
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">print</span>(closest_comp)                      <span class="co"># for comparison</span></a></code></pre></div>
<pre><code>##      N       P      K      Ca     Mg     Fv     
## [1,] 0.04885 0.0035 0.0448 0.0192 0.0037 0.87995
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<p>So, the assumption is true. The next codes show the concept using dots plots and histograms for each vector. A data frame is tidded for ggplot. Visualization is better with histograms.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(misbalanced, closest, clr_diff),</a>
<a class="sourceLine" id="cb52-2" title="2">                 <span class="dt">vectors =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Reference&quot;</span>, <span class="st">&quot;Perturbation&quot;</span>)))</a>
<a class="sourceLine" id="cb52-3" title="3">df<span class="op">$</span>vectors &lt;-<span class="st"> </span>df<span class="op">$</span>vectors <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_relevel</span>(<span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Reference&quot;</span>, <span class="st">&quot;Perturbation&quot;</span>)</a>
<a class="sourceLine" id="cb52-4" title="4">dfreshape &lt;-<span class="st"> </span><span class="kw">melt</span>(df) <span class="co"># reshapes df for ggplot</span></a></code></pre></div>
<pre><code>## Using vectors as id variables</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">dfreshape &lt;-<span class="st"> </span><span class="kw">melt</span>(df)</a></code></pre></div>
<pre><code>## Using vectors as id variables</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">dfreshape<span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern =</span> <span class="st">&quot;clr_&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> dfreshape<span class="op">$</span>variable, <span class="dt">fixed =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="st">  </span><span class="kw">fct_relevel</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Fv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> dfreshape, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> vectors, <span class="dt">colour =</span> vectors)) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;Nutrient clr coordinate&#39;</span>, <span class="dt">y =</span><span class="st">&#39;&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Arial&quot;</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">12</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hi-perturb-dotplot"></span>
<img src="2019_Bookdown_files/figure-html/hi-perturb-dotplot-1.png" alt="Perturbation vector computation example dotplot using the most imbalanced foliar sample." width="100%" />
<p class="caption">
Figure 4.2: Perturbation vector computation example dotplot using the most imbalanced foliar sample.
</p>
</div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">ggsave</span>(<span class="st">&quot;images/perturb_dotplot.tiff&quot;</span>,  <span class="dt">width =</span> <span class="dv">7</span>, <span class="dt">height =</span> <span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dfreshape, <span class="kw">aes</span>(<span class="dt">x =</span> variable, <span class="dt">y =</span> value, <span class="dt">fill =</span> vectors)) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> vectors), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Nutrients clr coordinates&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Diagnostic nutrients&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Arial&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb59-7" title="7">g1 <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_discrete</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;Observation&quot;</span>,<span class="st">&quot;Reference&quot;</span>,<span class="st">&quot;Perturbation&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb59-8" title="8"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;grey50&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey80&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hi-perturb-barplot"></span>
<img src="2019_Bookdown_files/figure-html/hi-perturb-barplot-1.png" alt="Perturbation vector computation example barplot using the most imbalanced foliar sample." width="100%" />
<p class="caption">
Figure 4.3: Perturbation vector computation example barplot using the most imbalanced foliar sample.
</p>
</div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">ggsave</span>(<span class="st">&quot;images/perturb_barplot.tiff&quot;</span>,  <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">4</span>)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter-Modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["2019_Bookdown.pdf", "2019_Bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
