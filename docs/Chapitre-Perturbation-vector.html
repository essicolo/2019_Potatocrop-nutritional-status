<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Perturbation vector theory | Nutrient Diagnosis Of Potato</title>
  <meta name="description" content="This is a example of using the bookdown package to write a book for publication on Github. The output format for this example is bookdown::gitbook. Next features are set for after (bibliography and links)." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Perturbation vector theory | Nutrient Diagnosis Of Potato" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a example of using the bookdown package to write a book for publication on Github. The output format for this example is bookdown::gitbook. Next features are set for after (bibliography and links)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Perturbation vector theory | Nutrient Diagnosis Of Potato" />
  
  <meta name="twitter:description" content="This is a example of using the bookdown package to write a book for publication on Github. The output format for this example is bookdown::gitbook. Next features are set for after (bibliography and links)." />
  

<meta name="author" content="zcoulibali" />


<meta name="date" content="2019-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapitre-Modeling.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Data processing</a></li>
<li class="chapter" data-level="2" data-path="chapitre-Clustering.html"><a href="chapitre-Clustering.html"><i class="fa fa-check"></i><b>2</b> Cluster analysis of potato cultivars</a></li>
<li class="chapter" data-level="3" data-path="Chapitre-Modeling.html"><a href="Chapitre-Modeling.html"><i class="fa fa-check"></i><b>3</b> Predicting marketable tuber yield</a></li>
<li class="chapter" data-level="4" data-path="Chapitre-Perturbation-vector.html"><a href="Chapitre-Perturbation-vector.html"><i class="fa fa-check"></i><b>4</b> Perturbation vector theory</a><ul>
<li class="chapter" data-level="4.1" data-path="Chapitre-Perturbation-vector.html"><a href="Chapitre-Perturbation-vector.html#dissimilarity-index-between-compositions"><i class="fa fa-check"></i><b>4.1</b> Dissimilarity index between compositions</a></li>
<li class="chapter" data-level="4.2" data-path="Chapitre-Perturbation-vector.html"><a href="Chapitre-Perturbation-vector.html#rebalancing-a-misbalanced-sample-by-perturbation"><i class="fa fa-check"></i><b>4.2</b> Rebalancing a misbalanced sample by perturbation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Nutrient Diagnosis Of Potato</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapitre-Perturbation-vector" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Perturbation vector theory</h1>
<p>The first step is to compute a dissimilarity index according to the distance from the closest healthy point (the closest TN). Let’s load data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)     <span class="co"># dplyr and ggplot2</span>
<span class="kw">library</span>(extrafont)        <span class="co"># Changing Fonts for Graphs</span>

train_df =<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/train_df.csv&quot;</span>)
train_df &lt;-<span class="st"> </span>train_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>X.<span class="dv">1</span>, <span class="op">-</span>X) <span class="co"># to discard extra columns</span>
train_df<span class="op">$</span>group_i =<span class="st"> </span><span class="kw">factor</span>(train_df<span class="op">$</span>group_i)</code></pre></div>
<p>As considered in previous <code>1.2_machine learning.ipynb</code> file, True Negatives (TN) specimens in this study are observations of the training data set with high yield (HY) and correctly predicted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TNs =<span class="st"> </span>train_df[train_df<span class="op">$</span>yieldClass <span class="op">==</span><span class="st"> &#39;HY&#39;</span> <span class="op">&amp;</span><span class="st"> </span>train_df<span class="op">$</span>pred_yield <span class="op">==</span><span class="st"> &#39;HY&#39;</span>, ]
clrNo =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;clrN&quot;</span>, <span class="st">&quot;clrP&quot;</span>, <span class="st">&quot;clrK&quot;</span>, <span class="st">&quot;clrCa&quot;</span>, <span class="st">&quot;clrMg&quot;</span>, <span class="st">&quot;clrFv&quot;</span>) <span class="co"># for simplicity</span></code></pre></div>
<div id="dissimilarity-index-between-compositions" class="section level2">
<h2><span class="header-section-number">4.1</span> Dissimilarity index between compositions</h2>
<ul>
<li>Euclidean distance as dissimilarity index</li>
<li>For each composition (line) in the “unbalanced specimens”, calculate all the euclidean distances between all the compositions in “TNs” of the corresponding group</li>
<li>Return the smallest euclidean distance as the unbalanced index of the composition.</li>
</ul>
<p>Function to compute euclidean distance</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eucl_dist_f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
    <span class="kw">sqrt</span>(<span class="kw">sum</span>((x<span class="op">-</span>y)<span class="op">^</span><span class="dv">2</span>))
}</code></pre></div>
<p>Compute debalance (or imbalance) index (<code>debal</code>) using this loop.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">debal &lt;-<span class="st"> </span><span class="kw">c</span>()
debal_index &lt;-<span class="st"> </span><span class="kw">c</span>()
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(train_df)) {
    clr_i &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(train_df[i, clrNo])
    eucl_dist &lt;-<span class="st"> </span><span class="kw">apply</span>(TNs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(group_i <span class="op">==</span><span class="st"> </span>train_df[i, <span class="st">&#39;group_i&#39;</span>]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(clrNo), 
                       <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">eucl_dist_f</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>clr_i))
    debal_index[i] &lt;-<span class="st"> </span><span class="kw">which.min</span>(eucl_dist)
    debal[i] &lt;-<span class="st"> </span>eucl_dist[debal_index[i]]
}
train_df<span class="op">$</span>debal &lt;-<span class="st"> </span>debal
train_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</code></pre></div>
<pre><code>## Observations: 2,527
## Variables: 16
## $ NoEssai      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ NoBloc       &lt;int&gt; 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3...
## $ NoTraitement &lt;int&gt; 1, 3, 5, 6, 7, 8, 1, 2, 3, 5, 2, 3, 4, 5, 6, 7, 8...
## $ clrN         &lt;dbl&gt; 0.3321186, 0.4453417, 0.6519389, 0.4885647, 0.720...
## $ clrP         &lt;dbl&gt; -2.518325, -2.365429, -2.468221, -2.525335, -2.30...
## $ clrK         &lt;dbl&gt; 0.8379383, 1.0112272, 0.8242433, 0.9418880, 0.720...
## $ clrMg        &lt;dbl&gt; -1.639076, -1.990736, -1.775074, -1.763195, -1.70...
## $ clrCa        &lt;dbl&gt; -0.4794688, -0.7290838, -0.7470790, -0.6426036, -...
## $ clrFv        &lt;dbl&gt; 3.466813, 3.628680, 3.514191, 3.500681, 3.432323,...
## $ Cultivar     &lt;fct&gt; Goldrush, Goldrush, Goldrush, Goldrush, Goldrush,...
## $ Maturity5    &lt;fct&gt; mid-season, mid-season, mid-season, mid-season, m...
## $ RendVendable &lt;dbl&gt; 18.94420, 33.03790, 46.00890, 41.01670, 46.79370,...
## $ yieldClass   &lt;fct&gt; LY, LY, HY, HY, HY, HY, LY, LY, HY, HY, LY, HY, H...
## $ group_i      &lt;fct&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...
## $ pred_yield   &lt;fct&gt; LY, HY, HY, HY, HY, HY, LY, HY, HY, HY, HY, HY, H...
## $ debal        &lt;dbl&gt; 0.1872777, 0.1588655, 0.0000000, 0.0000000, 0.000...</code></pre>
</div>
<div id="rebalancing-a-misbalanced-sample-by-perturbation" class="section level2">
<h2><span class="header-section-number">4.2</span> Rebalancing a misbalanced sample by perturbation</h2>
<p>Suppose we got this point selected at random in <code>unbalanced specimens</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#set.seed(932559) # random.org</span>
unbalanced &lt;-<span class="st"> </span><span class="kw">subset</span>(train_df, debal <span class="op">!=</span><span class="dv">0</span>)
misbalanced &lt;-<span class="st"> </span>unbalanced[<span class="kw">sample</span>(<span class="kw">nrow</span>(unbalanced), <span class="dv">1</span>), ]
misbalanced</code></pre></div>
<pre><code>##      NoEssai NoBloc NoTraitement      clrN      clrP      clrK     clrMg
## 1541     196      2           12 0.8039553 -3.542755 0.7991936 -1.704475
##           clrCa    clrFv Cultivar        Maturity5 RendVendable yieldClass
## 1541 0.07201663 3.572065 Superior early mid-season     31.14754         LY
##      group_i pred_yield    debal
## 1541       4         LY 1.121824</code></pre>
<p>Or even, you can use the most unbalanced occurrence, … why not !</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">misbalanced =</span> unbalanced[<span class="kw">which.max</span>(unbalanced<span class="op">$</span>debal), ])</code></pre></div>
<pre><code>##      NoEssai NoBloc NoTraitement     clrN     clrP        clrK     clrMg
## 1605     200      1            2 0.957698 -1.83199 -0.04637332 -2.247862
##          clrCa    clrFv Cultivar        Maturity5 RendVendable yieldClass
## 1605 0.4678508 2.700677 Superior early mid-season     30.37194         LY
##      group_i pred_yield    debal
## 1605       4         LY 1.211534</code></pre>
<p>How to rebalance it?</p>
<p>The first step is to find <code>in TNs of the corresponding ionomic group</code> the closest balanced point.</p>
<p>Let’s re-compute the euclidean distance, like for a new (an unknown) point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">misbalanced &lt;-<span class="st"> </span>misbalanced[clrNo]
eucl_dist_misbal &lt;-<span class="st"> </span><span class="kw">apply</span>(TNs[, clrNo], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">eucl_dist_f</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>misbalanced))
index_misbal &lt;-<span class="st"> </span><span class="kw">which.min</span>(<span class="kw">t</span>(<span class="kw">data.frame</span>(eucl_dist_misbal))) <span class="co"># return the index of the sample</span>
index_misbal</code></pre></div>
<pre><code>## [1] 479</code></pre>
<p>Euclidean distance matched with the corresponding <code>debal</code> value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">misbal =<span class="st"> </span>eucl_dist_misbal[index_misbal] <span class="co"># to compare to corresponding debal value</span>
misbal</code></pre></div>
<pre><code>##     1540 
## 1.211534</code></pre>
<p>The <code>closest point in the TNs</code> data set is this one:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">closest &lt;-<span class="st"> </span>TNs[index_misbal, ]
closest</code></pre></div>
<pre><code>##      NoEssai NoBloc NoTraitement      clrN      clrP      clrK     clrMg
## 1540     196      2           11 0.5819154 -2.201392 0.4035754 -1.854012
##           clrCa    clrFv Cultivar        Maturity5 RendVendable yieldClass
## 1540 -0.2247718 3.294685 Superior early mid-season     32.56831         HY
##      group_i pred_yield
## 1540       4         HY</code></pre>
<p>Note that Ionomics groups of the misbalanced and the closest composition are the same … most of the times ! You need package <code>compositions</code> for further clr back-transformation de compositional space.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(<span class="st">&#39;compositions&#39;</span>)</code></pre></div>
<p>Perturbation in compositional space plays the same role as translation plays in real space. Some natural processes in nature can be interpreted as a change from one composition <code>C1</code> to another <code>C2</code> through the application of a perturbation:</p>
<blockquote>
<p><code>p ⊕ C1 ====&gt; C2</code>.</p>
</blockquote>
<p>The difference between <code>the new observation</code> and the closest TN composition can be back-transformed to the compositional space. The obtained vector is the <code>perturbation vector</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">closest =<span class="st"> </span>closest[clrNo]
clr_diff =<span class="st"> </span>closest <span class="op">-</span><span class="st"> </span>misbalanced
clr_diff</code></pre></div>
<pre><code>##            clrN       clrP      clrK      clrCa   clrMg     clrFv
## 1540 -0.3757826 -0.3694021 0.4499487 -0.6926226 0.39385 0.5940087</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">comp_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Mg&quot;</span>, <span class="st">&quot;Fv&quot;</span>)
perturbation_vector &lt;-<span class="st"> </span><span class="kw">clrInv</span>(clr_diff)
<span class="kw">names</span>(perturbation_vector) &lt;-<span class="st"> </span>comp_names</code></pre></div>
<p>Compute the compositions of the ilr coordinates of the misbalanced point, as well as the closest TN point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">misbal_comp &lt;-<span class="st"> </span><span class="kw">clrInv</span>(misbalanced)
<span class="kw">names</span>(misbal_comp) &lt;-<span class="st"> </span>comp_names

closest_comp &lt;-<span class="st"> </span><span class="kw">clrInv</span>(closest)
<span class="kw">names</span>(closest_comp) &lt;-<span class="st"> </span>comp_names

pmc =<span class="st"> </span><span class="kw">rbind</span>(perturbation_vector, misbal_comp, closest_comp)
<span class="kw">rownames</span>(pmc) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;perturbation_vector&quot;</span>,<span class="st">&quot;misbal_comp&quot;</span>,<span class="st">&quot;closest_comp&quot;</span>)
pmc <span class="co"># data frame made up of perturbation vector, misbalanced composition and the closest reference sample</span></code></pre></div>
<pre><code>##                              N           P         K         Ca        Mg
## perturbation_vector 0.10188730 0.102539477 0.2326648 0.07421954 0.2199719
## misbal_comp         0.12828046 0.007881602 0.0470000 0.07860000 0.0052000
## closest_comp        0.05713207 0.003532686 0.0478000 0.02550000 0.0050000
##                            Fv
## perturbation_vector 0.2687170
## misbal_comp         0.7330379
## closest_comp        0.8610352</code></pre>
<p>For each vector, check that the simplex is closed to 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(perturbation_vector); <span class="kw">sum</span>(misbal_comp); <span class="kw">sum</span>(closest_comp)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<pre><code>## [1] 1</code></pre>
<pre><code>## [1] 1</code></pre>
<p>The closest composition minus the misbalanced composition should return the perturbation vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(closest_comp <span class="op">-</span><span class="st"> </span>misbal_comp) <span class="co"># soustraction</span></code></pre></div>
<pre><code>##      N         P         K         Ca         Mg        Fv      
## 1540 0.1018873 0.1025395 0.2326648 0.07421954 0.2199719 0.268717
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(perturbation_vector)        <span class="co"># for comparison</span></code></pre></div>
<pre><code>##      N         P         K         Ca         Mg        Fv      
## 1540 0.1018873 0.1025395 0.2326648 0.07421954 0.2199719 0.268717
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<p>Or even, perturb the misbalanced point by the perturbation vector, you should obtain the closest TN point:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(misbal_comp <span class="op">+</span><span class="st"> </span>perturbation_vector) <span class="co"># perturbation</span></code></pre></div>
<pre><code>##      N          P           K      Ca     Mg    Fv       
## 1605 0.05713207 0.003532686 0.0478 0.0255 0.005 0.8610352
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(closest_comp)                      <span class="co"># for comparison</span></code></pre></div>
<pre><code>##      N          P           K      Ca     Mg    Fv       
## 1540 0.05713207 0.003532686 0.0478 0.0255 0.005 0.8610352
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
<p>So, the assumption is true.</p>
<p>The next codes try to show the concept using plots using clr coordinates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">rbind</span>(misbalanced, closest, clr_diff)) <span class="co"># mis, cl, per</span>
vectors =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;observation&quot;</span>, <span class="st">&quot;reference&quot;</span>, <span class="st">&quot;perturbation&quot;</span>)
d<span class="op">$</span>vectors =<span class="st"> </span><span class="kw">factor</span>(vectors)
d</code></pre></div>
<pre><code>##             clrN       clrP        clrK      clrCa     clrMg     clrFv
## 1605   0.9576980 -1.8319897 -0.04637332  0.4678508 -2.247862 2.7006765
## 1540   0.5819154 -2.2013919  0.40357540 -0.2247718 -1.854012 3.2946852
## 15401 -0.3757826 -0.3694021  0.44994872 -0.6926226  0.393850 0.5940087
##            vectors
## 1605   observation
## 1540     reference
## 15401 perturbation</code></pre>
<p>This data frame must be reshape for ggplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(<span class="st">&quot;reshape&quot;</span>) <span class="co"># function melt() </span>
dreshape =<span class="st"> </span><span class="kw">melt</span>(d)
dreshape</code></pre></div>
<pre><code>##         vectors variable       value
## 1   observation     clrN  0.95769802
## 2     reference     clrN  0.58191537
## 3  perturbation     clrN -0.37578265
## 4   observation     clrP -1.83198972
## 5     reference     clrP -2.20139186
## 6  perturbation     clrP -0.36940213
## 7   observation     clrK -0.04637332
## 8     reference     clrK  0.40357540
## 9  perturbation     clrK  0.44994872
## 10  observation    clrCa  0.46785078
## 11    reference    clrCa -0.22477179
## 12 perturbation    clrCa -0.69262257
## 13  observation    clrMg -2.24786229
## 14    reference    clrMg -1.85401233
## 15 perturbation    clrMg  0.39384997
## 16  observation    clrFv  2.70067654
## 17    reference    clrFv  3.29468520
## 18 perturbation    clrFv  0.59400866</code></pre>
<p>Plot with dots for each vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">6</span>, <span class="dt">repr.plot.height =</span> <span class="dv">3</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> dreshape, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> vectors)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&#39;clr coordinate&#39;</span>, <span class="dt">y =</span><span class="st">&#39;&#39;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Arial&quot;</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">12</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hi-perturb-dotplot"></span>
<img src="2019_Bookdown_files/figure-html/hi-perturb-dotplot-1.png" alt="Perturbation vector computation example dotplot using the most imbalanced foliar sample." width="100%" />
<p class="caption">
Figure 4.1: Perturbation vector computation example dotplot using the most imbalanced foliar sample.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ggsave(&quot;images/perturb_dotplot.tiff&quot;,  width = 6, height = 4)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">repr.plot.width =</span> <span class="dv">5</span>, <span class="dt">repr.plot.height =</span> <span class="dv">3</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>dreshape, <span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value, <span class="dt">fill=</span>vectors)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>()) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">family=</span><span class="st">&quot;Arial&quot;</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>, <span class="dt">size=</span><span class="dv">12</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hi-perturb-barplot"></span>
<img src="2019_Bookdown_files/figure-html/hi-perturb-barplot-1.png" alt="Perturbation vector computation example barplot using the most imbalanced foliar sample." width="100%" />
<p class="caption">
Figure 4.2: Perturbation vector computation example barplot using the most imbalanced foliar sample.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ggsave(&quot;images/perturb_barplot.tiff&quot;,  width = 6, height = 4)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapitre-Modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["2019_Bookdown.pdf", "2019_Bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
